version: '3.8'

services:
  backend:
    build: 
      context: .
      dockerfile: Dockerfile
    container_name: ms-trust-backend
    ports:
      - "8181:80"
    environment:
      # Cấu hình Server Port (override port 8080 thành 80 trong container)
      - SERVER_PORT=80
      # Cấu hình kết nối Database trỏ về MySQL server hiện tại
      - SPRING_DATASOURCE_URL=jdbc:mysql://104.199.231.104:3306/MS.TrustTest?useSSL=false&serverTimezone=Asia/Ho_Chi_Minh&allowPublicKeyRetrieval=true
      - SPRING_DATASOURCE_USERNAME=nvmanh
      - SPRING_DATASOURCE_PASSWORD=!M@nh1989
      # Cấu hình FTP (giữ nguyên như application.yml)
      - FTP_SERVER=153.92.11.239
      - FTP_PORT=21
      - FTP_USERNAME=u341775345.admin
      - FTP_PASSWORD=!M@nh1989
    restart: unless-stopped
    deploy:
      resources:
        limits:
          memory: 1G
        reservations:
          memory: 512M
