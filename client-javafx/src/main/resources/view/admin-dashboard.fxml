<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>

<ScrollPane xmlns="http://javafx.com/javafx/17" 
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.mstrust.client.admin.controller.AdminDashboardController"
            fitToWidth="true"
            hbarPolicy="NEVER"
            vbarPolicy="AS_NEEDED"
            styleClass="admin-dashboard"
            stylesheets="@../css/admin-styles.css">
    
    <VBox spacing="20" styleClass="dashboard-container">
        <padding>
            <Insets top="20" right="20" bottom="20" left="20"/>
        </padding>
        
        <!-- Header -->
        <HBox alignment="CENTER_LEFT" spacing="10">
            <Label text="ðŸ“Š Admin Dashboard" styleClass="dashboard-title"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="refreshButton" text="LÃ m má»›i" onAction="#handleRefresh"/>
        </HBox>
        
        <Separator/>
        
        <!-- Statistics Cards -->
        <GridPane hgap="15" vgap="15" styleClass="stats-grid">
            <columnConstraints>
                <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
            </columnConstraints>
            
            <!-- Total Users Card -->
            <VBox styleClass="stat-card" GridPane.columnIndex="0">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Label text="ðŸ‘¥" styleClass="stat-icon"/>
                <Label fx:id="totalUsersLabel" text="0" styleClass="stat-value"/>
                <Label text="Tá»•ng NgÆ°á»i dÃ¹ng" styleClass="stat-label"/>
            </VBox>
            
            <!-- Active Exams Card -->
            <VBox styleClass="stat-card" GridPane.columnIndex="1">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Label text="ðŸ“" styleClass="stat-icon"/>
                <Label fx:id="activeExamsLabel" text="0" styleClass="stat-value"/>
                <Label text="Äá» thi HÃ´m nay" styleClass="stat-label"/>
            </VBox>
            
            <!-- Total Submissions Card -->
            <VBox styleClass="stat-card" GridPane.columnIndex="2">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Label text="ðŸ“„" styleClass="stat-icon"/>
                <Label fx:id="totalSubmissionsLabel" text="0" styleClass="stat-value"/>
                <Label text="Tá»•ng BÃ i ná»™p" styleClass="stat-label"/>
            </VBox>
            
            <!-- Alerts Card -->
            <VBox styleClass="stat-card" GridPane.columnIndex="3">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Label text="âš ï¸" styleClass="stat-icon"/>
                <Label fx:id="alertsCountLabel" text="0" styleClass="stat-value"/>
                <Label text="Cáº£nh bÃ¡o (7 ngÃ y)" styleClass="stat-label"/>
            </VBox>
        </GridPane>
        
        <!-- System Health Panel -->
        <VBox spacing="10" styleClass="health-panel">
            <Label text="ðŸ’š TÃ¬nh tráº¡ng Há»‡ thá»‘ng" styleClass="section-title"/>
            <GridPane hgap="15" vgap="10">
                <columnConstraints>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                </columnConstraints>
                
                <!-- CPU Usage -->
                <VBox GridPane.columnIndex="0">
                    <Label text="CPU Usage" styleClass="health-label"/>
                    <ProgressBar fx:id="cpuProgressBar" progress="0" styleClass="health-progress"/>
                    <Label fx:id="cpuLabel" text="0%" styleClass="health-value"/>
                </VBox>
                
                <!-- Memory Usage -->
                <VBox GridPane.columnIndex="1">
                    <Label text="Memory Usage" styleClass="health-label"/>
                    <ProgressBar fx:id="memoryProgressBar" progress="0" styleClass="health-progress"/>
                    <Label fx:id="memoryLabel" text="0%" styleClass="health-value"/>
                </VBox>
                
                <!-- Disk Usage -->
                <VBox GridPane.columnIndex="2">
                    <Label text="Disk Usage" styleClass="health-label"/>
                    <ProgressBar fx:id="diskProgressBar" progress="0" styleClass="health-progress"/>
                    <Label fx:id="diskLabel" text="0%" styleClass="health-value"/>
                </VBox>
                
                <!-- DB Connections -->
                <VBox GridPane.columnIndex="3">
                    <Label text="DB Connections" styleClass="health-label"/>
                    <Label fx:id="dbConnectionsLabel" text="0/0" styleClass="health-value-large"/>
                </VBox>
            </GridPane>
        </VBox>
        
        <!-- Charts Section -->
        <GridPane hgap="15" vgap="15" styleClass="charts-grid">
            <columnConstraints>
                <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
            </columnConstraints>
            
            <!-- Exams Per Day Chart -->
            <VBox spacing="10" GridPane.columnIndex="0" styleClass="chart-container">
                <Label text="ðŸ“ˆ Äá» thi theo NgÃ y" styleClass="section-title"/>
                <StackPane fx:id="examsChartContainer">
                    <LineChart fx:id="examsPerDayChart" styleClass="dashboard-chart">
                        <xAxis>
                            <CategoryAxis label="NgÃ y"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis label="Sá»‘ lÆ°á»£ng"/>
                        </yAxis>
                    </LineChart>
                    <VBox fx:id="examsChartLoading" alignment="CENTER" spacing="10" 
                          style="-fx-background-color: rgba(255,255,255,0.9);" 
                          visible="false" managed="false">
                        <ProgressIndicator styleClass="loading-spinner"/>
                        <Label text="Äang táº£i dá»¯ liá»‡u..." styleClass="loading-message"/>
                    </VBox>
                </StackPane>
            </VBox>
            
            <!-- Pass Rate Trend Chart -->
            <VBox spacing="10" GridPane.columnIndex="1" styleClass="chart-container">
                <Label text="ðŸ“Š Tá»· lá»‡ Äá»— theo Thá»i gian" styleClass="section-title"/>
                <StackPane fx:id="passRateChartContainer">
                    <LineChart fx:id="passRateChart" styleClass="dashboard-chart">
                        <xAxis>
                            <CategoryAxis label="Thá»i gian"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis label="Tá»· lá»‡ (%)" upperBound="100"/>
                        </yAxis>
                    </LineChart>
                    <VBox fx:id="passRateChartLoading" alignment="CENTER" spacing="10" 
                          style="-fx-background-color: rgba(255,255,255,0.9);" 
                          visible="false" managed="false">
                        <ProgressIndicator styleClass="loading-spinner"/>
                        <Label text="Äang táº£i dá»¯ liá»‡u..." styleClass="loading-message"/>
                    </VBox>
                </StackPane>
            </VBox>
        </GridPane>
        
        <!-- Alert Distribution Chart -->
        <VBox spacing="10" styleClass="chart-container">
            <Label text="ðŸ¥§ PhÃ¢n bá»‘ Cáº£nh bÃ¡o" styleClass="section-title"/>
            <StackPane fx:id="alertChartContainer">
                <PieChart fx:id="alertDistributionChart" styleClass="dashboard-chart" prefHeight="300"/>
                <VBox fx:id="alertChartLoading" alignment="CENTER" spacing="10" 
                      style="-fx-background-color: rgba(255,255,255,0.9);" 
                      visible="false" managed="false">
                    <ProgressIndicator styleClass="loading-spinner"/>
                    <Label text="Äang táº£i dá»¯ liá»‡u..." styleClass="loading-message"/>
                </VBox>
            </StackPane>
        </VBox>
        
        <!-- Recent Activities Feed -->
        <VBox spacing="10" styleClass="activities-panel">
            <Label text="ðŸ• Hoáº¡t Ä‘á»™ng Gáº§n Ä‘Ã¢y" styleClass="section-title"/>
            <ListView fx:id="activitiesListView" styleClass="activities-list" prefHeight="200"/>
        </VBox>
        
        <!-- Quick Actions Panel -->
        <VBox spacing="10" styleClass="actions-panel">
            <Label text="âš¡ Thao tÃ¡c Nhanh" styleClass="section-title"/>
            <HBox spacing="10">
                <Button text="Quáº£n lÃ½ NgÆ°á»i dÃ¹ng" onAction="#handleUserManagement" styleClass="quick-action-button"/>
                <Button text="Quáº£n lÃ½ Tá»• chá»©c" onAction="#handleOrganization" styleClass="quick-action-button"/>
                <Button text="Cáº¥u hÃ¬nh Há»‡ thá»‘ng" onAction="#handleSystemConfig" styleClass="quick-action-button"/>
                <Button text="BÃ¡o cÃ¡o" onAction="#handleReports" styleClass="quick-action-button"/>
            </HBox>
        </VBox>
        
    </VBox>
    
</ScrollPane>

