### Test Start Exam Fix - Attempt 2
### Scenario: Student 5 đã có 1 GRADED submission cho exam 5
### Giờ test làm attempt thứ 2

# Step 1: Login as student
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "student1@example.com",
  "password": "password123"
}

### Step 2: Start Exam (Should handle UK constraint violation)
POST http://localhost:8080/api/exam-taking/start/5
Authorization: Bearer {{token_from_step1}}
Content-Type: application/json

### Step 3: Check database sau khi fix
# Kiểm tra xem có submission mới được tạo không

### Expected Results:
# 1. Không còn lỗi "Duplicate entry '5-5' for key 'uk_exam_student'"
# 2. Logic trong ExamTakingService sẽ detect constraint violation
# 3.  Tạo submission mới với attempt_number = 2
# 4.  Hoặc return existing active submission nếu có

### Test Cases:
# Case 1: Student chưa có active submission -> Tạo attempt 2
# Case 2: Student có active submission -> Return existing
# Case 3: Constraint violation -> Handle gracefully
